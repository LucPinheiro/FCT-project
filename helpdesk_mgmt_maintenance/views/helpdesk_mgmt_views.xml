<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!--###########################################
    # Helpdesk Ticket: 
    ############################################-->

    <!-- Helpdesk Ticket kanban view -->






    <!-- Helpdesk Ticket tree view -->
    <record id="help_main_helpdesk_ticket_tree" model="ir.ui.view">
        <field name="name">helpdesk.ticket.tree (Helpdesk Maintenance)</field>
        <field name="model">helpdesk.ticket</field>
        <field name="inherit_id" ref="helpdesk_mgmt.ticket_view_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='project_id']" position="after">
                <field name="task_id" />
            </xpath>
            <xpath expr="//field[@name='last_stage_update']" position="after">
                <field name="equipment_ids_count" string="NÂº equip" />
                <field name="progress"  widget="progressbar" optional="show" />
                <!-- <field name="progress" widget="progressbar" optional="show" options="{'current_value': 'progress', 'max_value': '100', 'editable': true}"/> -->
            </xpath>
        </field>
    </record>


    <!-- Default filter  Project-->
        <!-- <record id="hr_attendance.hr_attendance_action" model="ir.actions.act_window">
            <field name="context">{"search_default_this_week": 1} </field>
        </record> -->

    <!-- Project button action  -->
    <record id="helpdesk_tickets_action_from_project" model="ir.actions.act_window">
    <field name="name">Project Project</field> 
    <field name="res_model">project.project</field>
    <field name="binding_model_id" ref="project.model_project_project"/> 
    <field name="view_mode">kanban,tree,form</field>
    </record> 

    <!-- Tasks Project button action  -->
    <record id="helpdesk_tickets_action_from_project_task" model="ir.actions.act_window">
    <field name="name">Project Tack</field> 
    <field name="res_model">project.task</field>
    <field name="binding_model_id" ref="project.model_project_task"/> 
    <field name="view_mode">kanban,tree,form</field>
    <field name="domain">[('ticket_ids', '=', active_id)]</field>
    </record>

    <!-- Default filter  Equipament-->
        <!-- <record id="hr_attendance.hr_attendance_action" model="ir.actions.act_window">
            <field name="context">{"search_default_this_week": 1} </field>
        </record> -->

    <!-- Equipment button action -->
    <record id="helpdesk_tickets_action_from_equipment" model="ir.actions.act_window">
    <field name="name">Maintenance Equipment</field>
    <field name="res_model">maintenance.equipment</field>
    <field name="binding_model_id" ref="maintenance.model_maintenance_equipment"/> 
    <field name="view_mode">kanban,tree,form</field>
    <field name="domain">[('ticket_ids', '=', active_id)]</field>
    </record> 

    <!-- Helpdesk Ticket form view -->
    <record id="help_main_helpdesk_ticket_form" model="ir.ui.view">
        <field name="name">helpdesk.ticket.form (Helpdesk Maintenance)</field>
        <field name="model">helpdesk.ticket</field>
        <field name="inherit_id" ref="helpdesk_mgmt.ticket_view_form"/>
        <field name="arch" type="xml">
            <!-- Helpdesk Ticket XAPTH HEADER BUTTON -->
            <!-- context="{'search_default_equipment_ids': active_id, 'default_equipment_ids': active_id}" -->
            <xpath expr="//div[hasclass('oe_button_box')]" position="inside">
                <!-- Project count button -->
                <button class="oe_stat_button" name="%(helpdesk_mgmt_projects_action)d"
                    type="action" icon="fa-puzzle-piece"
                    attrs="{'invisible': [('project_id', '=', False)]}">
                    <div class="o_field_widget o_stat_info">
                        <span class="o_stat_value">
                            <field name="project_id" invisible="1"/>
                            <field name="project_id_count" widget="statinfo" nolabel="1" class="mr4" />
                        </span>
                        <span class="o_stat_text">Project</span>
                    </div>
                </button>
                <!-- Task count button -->
                <button class="oe_stat_button" name="%(helpdesk_tickets_action_from_project_task)d"
                    type="action" icon="fa-tasks"
                    attrs="{'invisible': [('task_id', '=', False)]}">
                    <div class="o_field_widget o_stat_info">
                        <span class="o_stat_value">
                            <field name="task_id" invisible="1"/>
                            <field name="task_id_count" widget="statinfo" nolabel="1" class="mr4" />
                        </span>
                        <span class="o_stat_text">Task</span>
                    </div>
                </button>
                <!-- Equipment count Button -->
                <button class="oe_stat_button" name="%(helpdesk_tickets_action_from_equipment)d"
                    type="action" icon="fa-cubes"
                    attrs="{'invisible': [('equipment_ids', '=', False)]}">
                    <div class="o_field_widget o_stat_info">
                        <span class="o_stat_value">
                            <field name="equipment_ids" invisible="1"/>
                            <field name="equipment_ids_count" widget="statinfo" nolabel="1" class="mr4" />
                        </span>
                        <span class="o_stat_text">Equipment</span>
                    </div>
                </button>
            </xpath>

            <!-- Helpdesk Ticket XAPTH BODY -->
            <xpath expr="//field[@name='priority']" position="after">
                    <field name="equipment_id" />
            </xpath>
            <xpath expr="//group//field[@name='tag_ids']" position="after">
                <field name="equipment_id" string='Equipment'/>
                    <field name="progress" />
                <field name="planned_hours" />
                <field name="initially_hours" />
            </xpath>
            <xpath expr="//notebook//page[@name='other_info']" position="after">
                <page string="Maintenance">
                    <group>
                    <field name="equipment_ids" widget='many2many_tags' />
                    <field name="employee_id" />
                    <field name="departament_id" />
                    <field name="serial_no"  string='Serial Number' />
                    <field name="model_equipament" string='Modal'/>
                    <field name="category_id" />
                    <field name="cost" string='Cost' />

                    </group>

                </page>

                <page string="Timesheet">
                    <group>

                    </group>
                </page>

                <page string="Traceability">
                    <group>

                    </group>
                </page>

                
                <page string="Work Information">
                    <group>

                    </group>
                </page>

            </xpath>

            <!-- Remove requirements description field -->
            <!-- <xpath expr="//notebook//page[@name='description']" position="attributes">
            <attribute name="required">False</attribute>
            </xpath> -->
            <!-- <xpath expr="//notebook//page[@name='description']" position="attributes">
            <attribute name="invisible">1</attribute>
            </xpath> -->

        </field>
    </record>
    


    <!-- Helpdesk Ticket Search view -->






    <!-- Helpdesk Ticket kanban view -->

    <!-- Helpdesk kanban view -->

    <!-- Helpdesk kanban view -->

    <!-- Helpdesk kanban view -->


    <!--###########################################
    # Helpdesk Ticket Stages: 
    ###########################################-->

    <record id="help_main_helpdesk_ticket_stage_tree" model="ir.ui.view">
        <field name="name">helpdesk.ticket.stage.tree (Helpdesk Maintenance)</field>
        <field name="model">helpdesk.ticket.stage</field>
        <field name="inherit_id" ref="helpdesk_mgmt.view_helpdesk_ticket_stage_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='name']" position="after">
                <field name="ticket_id"  string='Tickets' widget='many2many_tags' />
            </xpath>
        </field>
    </record>

    <record id="help_main_helpdesk_ticket_stage_form" model="ir.ui.view">
        <field name="name">helpdesk.ticket.stage.form (Helpdesk Maintenance)</field>
        <field name="model">helpdesk.ticket.stage</field>
        <field name="inherit_id" ref="helpdesk_mgmt.view_helpdesk_ticket_stage_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='sequence']" position="before">
                <field name="ticket_id"  string='Tickets' widget='many2many_tags' />
            </xpath>
        </field>
    </record>

    

</odoo>
